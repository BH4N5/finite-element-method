\documentclass{myclass}
\usepackage[polish]{babel}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{/pgfplots/error bars/error bar style={very thick}}
\pgfplotsset{every axis plot/.append style={very thick, black}}

\begin{document}
\begin{flushright}
    Bartosz Hanc
\end{flushright}

\subsection*{Projekt z przedmiotu \textit{Równania różniczkowe i różnicowe}}

\subsubsection*{Sformułowanie słabe problemu i jego dyskretyzacja}

Przydzielone równanie różniczkowe to problem odkształcenia sprężystego postaci
\begin{equation}\label{eq:problem}
    \dv{}{x}\left(E(x)\dv{u}{x}\right) = 0\,,
\end{equation}
dla funkcji \(E(x)\) zdefiniowanej jako
\begin{equation}
    E(x) := \begin{cases}
        3&\text{dla \(x\in[0;1]\)}\\
        5&\text{dla \(x\in(1;2]\)}
    \end{cases}\quad,
\end{equation}
gdzie poszukiwana funkcja \(u:[0;2]\mapsto\mathbb{R}\) spełnia warunki brzegowe
\begin{equation}
    u(2) = 0\,,\quad u'(0)+u(0) = 10\,.
\end{equation}
Niech \(V := \{v(x):[0;2]\mapsto\mathbb{R}\, | \, v(2) = 0\}\). Mnożąc równanie
(\ref{eq:problem}) przez pewną funkcję \(v\in V\) i całkując przez części mamy
\begin{equation}
    \begin{split}
        0 & = \int\limits_{[0;2]} v(x)\dv{}{x}\left(Eu'\right)\dd{x} =vEu'\bigg|_0^2 - \int\limits_{[0;2]} Ev'u'\dd{x} \\ 
        & = -E(0)v(0)(10-u(0)) - \int\limits_{[0;2]} Ev'u'\dd{x}\,.
    \end{split}
\end{equation}
Sformułowanie słabe ma więc postać
\begin{equation}\label{eq:weak}
    \begin{split}
        &u(2) = 0 \\
        &\forall_{v\in V}:-E(0)v(0)u(0) + \int\limits_{[0;2]} Ev'u'\dd{x} = -10E(0)v(0)
    \end{split}
\end{equation}
Zdefiniujmy \(i\)--tą funkcję bazową \(v_i(x):[0;2]\mapsto\mathbb{R}\) jako
\begin{equation}
    v_i(x) = \begin{cases}
        \frac{x-x_{i-1}}{x_i - x_{i-1}}&\text{dla \(x\in [x_{i-1},x_i]\)}\\
        \frac{x_{i+1}-x}{x_{i+1} - x_{i}}&\text{dla \(x\in [x_{i},x_{i+1}]\)}\\
        0&\text{w.p.p.}
    \end{cases}\quad,
\end{equation}
gdzie \(i\in\{0,1,2,...,n\}\), a \(\{x_0,x_1,...,x_n\}\) są punktami podziału
odcinka \([0;2]\) (\(x_0=0\), \(x_n=2\)). W rozwiązaniu numerycznym przyjmiemy,
iż podział ten jest jednorodny tj. 
\begin{equation}
    \forall_{i\in\{0,...,n-1\}}: x_{i+1}-x_{i} = \delta x = \frac{2}{n}\,,
\end{equation}
wówczas \(x_{-1}=-\delta x\) i \(x_{n+1}=2+\delta x\). Niech
\(V_n=\text{Lin}\{v_0,v_1,...,v_n\} \subset V\). Przybliżając
\begin{equation}
    u(x)\approx \sum_{i=0}^na_iv_i(x)\,,\quad u'(x)\approx \sum_{i=0}^na_iv'_i(x)\,,
\end{equation}
otrzymujemy z (\ref{eq:weak}) układ równań liniowych postaci
\begin{equation}
    \forall_{i\in\{0,1,...,n-1\}}: \sum_{j=0}^{n-1} a_jb_{ij} = l_i\,,
\end{equation}
gdzie 
\begin{equation}
    \begin{split}
        &b_{ij} = \phi(v_i',v_j')-E(0)v_i(0)v_j(0)\,,\\
        &l_i =-10E(0)v_i(0)
    \end{split}
\end{equation}
oraz zdefiniowaliśmy odwzorowanie \(\phi\) jako
\begin{equation}
    \phi(v_i,v_j)=\int\limits_{[0;2]}E(x)v_iv_j\dd{x}\,.
\end{equation}
Wyprowadzony powyżej układ równań został rozwiązany numerycznie przy użyciu
języka programowania Julia.

\subsubsection*{Rozwiązanie analityczne}
Łatwo sprawdzić, iż rozwiązaniem równania (\ref{eq:problem}) z zadanymi
warunkami brzegowymi jest funkcja
\begin{equation}
    u(x) = \begin{cases}
        -\frac{50}{3} x + \frac{80}{3}&\text{dla \(x\in[0;1]\)}\\
        -10 x + 20&\text{dla \(x\in(1;2]\)}
    \end{cases}\quad.
\end{equation}
Na Rysunku \ref{fig:1} zamieszczono wykres powyższego rozwiązania w celu
porównania go z rozwiązaniem uzyskanym numerycznie.
\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            title={},
            xlabel={\(x\)},
            ylabel={\(y\)},
            xmin=0, xmax=2,
            ymin=0, ymax=27,
            ytick={0,5,10,15,20,25},
            xtick={0, 0.5,1,1.5,2},
            legend pos=north west,
            legend cell align={left},
            ymajorgrids=false,
            xmajorgrids=false,
            grid style=dashed,
            width = 8cm,
            height = 6cm
        ]

        \addplot [
            domain=0:1,
            samples=100, 
            color=black,
            line width = 1,
        ]
        {-50/3 * x + 80/3};

        \addplot [
            domain=1:2,
            samples=100, 
            color=black,
            line width = 1,
        ]
        {-10 * x + 20};

        \end{axis}
    \end{tikzpicture}

    \caption{Wykres rozwiązania równania \((E(x)u')'=0\) dla warunków brzegowych \(u(2)=0\), \(u'(0)+u(0)=10\)}

    \label{fig:1}
\end{figure}

\end{document}
